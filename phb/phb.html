<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>排行榜</title>
    <style type="text/css">
        #aa{MARGIN-RIGHT: auto;
            MARGIN-LEFT: auto;
            vertical-align:middle;
            height:150px;
            width:250px;
            border:1px solid #F00}
    </style>
</head>

<body>
<hr>
<input type="button" onclick="yes()" value=" 保 存 ">
<div id="aa">
</div>

<script language="JavaScript">
    var fso,ts,s;
    fso = new ActiveXObject("Scripting.FileSystemObject");
    ts = fso.OpenTextFile("d:\\test.txt",1);
    //读取全部文件
    s = ts.Readall();
    //分割文件信息为数组
    fsoArray=s.split("\r\n");
    //关闭文件
    ts.Close();
    s = null;
    //文件数据行数
    tlen=fsoArray.length;
    //输出行数
    //document.getElementById("ReadLen").value = tlen;
    //输出所有信息
    //document.getElementById("codeall").value = fsoArray.join("\r\n");

    var objectList = new Array();
    function Persion(name,score){
        this.name=name;
        this.score=score;
    }
/*
    objectList.push(new Persion('John',12341));
    objectList.push(new Persion('Michelle',10088));
    objectList.push(new Persion('Amy',15231));
    objectList.push(new Persion('Kim',8765));
    objectList.push(new Persion('Mary',11487));
*/
    for(var j=0;j<tlen;j+=2){
        objectList.push(new Persion(fsoArray[j],fsoArray[j+1]));
    }
    //新用户分数
    objectList.push(new Persion('Ben',12111));

    //分数从高到低排序
    objectList.sort(function(a,b){
        return b.score-a.score});

    //输出排行前3名
    for(var i=0;i<3;i++){
        document.getElementById("aa").innerHTML += objectList[i].name +'<br />';
        document.getElementById("aa").innerHTML += objectList[i].score+'<br />';
        //document.writeln('<br />'+objectList[i].name +' '+objectList[i].score);
    }

    //保存信息到本地文件
    function yes() {
        var strFile = "D:\\test.txt";
        var objFSO = new ActiveXObject("Scripting.FileSystemObject");
        var objStream = objFSO.CreateTextFile(strFile, true);
        /*
        for(var k=0;k<=tlen/2;k++){
            if(k<tlen/2) {
                objStream.WriteLine(objectList[k].name);
                objStream.WriteLine(objectList[k].score);
            }
            else{
                objStream.WriteLine(objectList[k].name);
                objStream.Write(objectList[k].score);
            }
        }
        */
        objStream.WriteLine(objectList[0].name);
        objStream.WriteLine(objectList[0].score);
        objStream.WriteLine(objectList[1].name);
        objStream.WriteLine(objectList[1].score);
        objStream.WriteLine(objectList[2].name);
        objStream.Write(objectList[3].score);

        objStream.Close(); // 关闭文件
        //alert("ok");
    }
</script>

</body>
</html>